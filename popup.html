<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="extensionName">缓存清理助手</title>
    <!-- 模块化 CSS 文件 -->
    <link rel="stylesheet" href="css/animate.min.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/tabs.css">
    <link rel="stylesheet" href="css/buttons.css">
    <link rel="stylesheet" href="css/storage-usage.css">
    <link rel="stylesheet" href="css/storage-detail.css">
    <link rel="stylesheet" href="css/domain-add-modal.css">
    <link rel="stylesheet" href="css/settings.css">
    <link rel="stylesheet" href="css/status.css">
    <link rel="stylesheet" href="css/themes.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body style="width: 520px; max-width: 520px; height: auto; overflow: hidden;">
    <div class="container animate__animated animate__fadeIn">
        <header class="header">
            <div class="header-icon"><svg t="1758867277084" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4711" data-spm-anchor-id="a313x.search_index.0.i0.65b83a81ebeYri" width="36" height="36"><path d="M768.036 354.847l184.73-184.336c26.695-26.598 26.695-69.785 0.097-96.486-26.599-26.598-69.689-26.598-96.39-0.097L671.55 258.458c-1.218 0.148-2.268 0.271-3.317 0.389h-0.016l-3.338 0.4c-71.066-41.227-153.416-41.033-216.73 19.43-1.863 1.766-1.96 5.007-0.097 6.87l292.895 292.895c1.864 1.864 5.105 1.767 6.871-0.097 60.365-63.411 60.56-145.664 19.435-216.73 0.128-1.653 0.297-2.933 0.477-4.331 0.102-0.753 0.204-1.541 0.307-2.437z m-493.03-148.803a58.301 58.301 0 1 0 116.607 0 58.301 58.301 0 0 0-116.608 0z m374.548 695.92a73.027 73.027 0 1 1 103.28-103.28 73.027 73.027 0 0 1-103.28 103.28zM790.81 773.182a39.752 39.752 0 1 0 79.508 0 39.752 39.752 0 0 0-79.508 0zM688.04 624.476L396.032 332.564a6.164 6.164 0 0 0-8.049-0.88C286.587 401.664 77.711 445.05 52.685 450.058c-1.372 0.292-1.864 1.762-1.178 2.944l52.613 98.74c0.492 0.885 1.567 1.28 2.55 0.982l142.229-50.35S147.896 587.96 130.033 602.388c-0.686 0.594-0.686 1.183-0.297 1.87 17.853 32.112 79.247 100.095 89.477 111.42l0.338 0.374c0.686 0.789 1.664 0.886 2.55 0.395L409.67 603.96S299.347 747.366 278.15 773.08c-0.589 0.589-0.491 1.183 0 1.869 32.195 43.679 136.53 113.858 136.53 113.858l26.598-36.613c46.234-67.041 107.971-132.608 117.591-142.223 9.12-9.119-79.897 177.346-89.39 197.222l-0.03 0.067c-0.487 0.983-0.098 2.058 0.788 2.652l99.134 59.776a2.079 2.079 0 0 0 3.046-1.572c21.3-176.68 100.9-310.364 116.705-335.59 1.567-2.652 1.075-5.888-1.08-8.049z" p-id="4712" data-spm-anchor-id="a313x.search_index.0.i1.65b83a81ebeYri" class="" fill="#f5222d"></path></svg></div>
            <div class="header-content">
                <h1 class="title" data-i18n="popupTitle">缓存清理助手 - 您的浏览器清理专家</h1>
                <div class="version">加载中...</div>
            </div>
            <div class="header-actions">
                <div class="header-language">
                    <button id="language-btn" class="language-icon-btn" title="语言设置">
                        <span class="language-icon">文<sub>A</sub></span>
                    </button>
                    <div id="language-menu" class="language-menu">
                        <div class="language-menu-item" data-lang="auto">
                            <span data-i18n="languageAuto">跟随系统</span>
                        </div>
                        <div class="language-menu-item" data-lang="zh_CN">简体中文</div>
                        <div class="language-menu-item" data-lang="en">English</div>
                        <div class="language-menu-item" data-lang="ja">日本語</div>
                        <div class="language-menu-item" data-lang="ko">한국어</div>
                        <div class="language-menu-item" data-lang="fr">Français</div>
                        <div class="language-menu-item" data-lang="de">Deutsch</div>
                        <div class="language-menu-item" data-lang="es">Español</div>
                        <div class="language-menu-item" data-lang="ru">Русский</div>
                    </div>
                </div>
                <div class="header-theme">
                    <button id="theme-btn" class="theme-icon-btn" title="主题设置">
                        <svg class="theme-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zM7.5 12c-.83 0-1.5-.67-1.5-1.5S6.67 9 7.5 9 9 9.67 9 10.5 8.33 12 7.5 12zm3-4C9.67 8 9 7.33 9 6.5S9.67 5 10.5 5 12 5.67 12 6.5 11.33 8 10.5 8zm5 4c-.83 0-1.5-.67-1.5-1.5S14.67 9 15.5 9 17 9.67 17 10.5 16.33 12 15.5 12zm3 4c-.83 0-1.5-.67-1.5-1.5S17.67 13 18.5 13 20 13.67 20 14.5 19.33 16 18.5 16z" fill="currentColor"/>
                        </svg>
                    </button>
                    <div id="theme-menu" class="theme-menu">
                        <div class="theme-menu-item" data-theme="auto">
                            <svg class="theme-menu-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z" fill="currentColor"/>
                            </svg>
                            <span data-i18n="themeAuto">自动</span>
                        </div>
                        <div class="theme-menu-item" data-theme="dark">
                            <svg class="theme-menu-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12.34 2.02C6.59 1.82 2 6.42 2 12c0 5.52 4.48 10 10 10 3.71 0 6.93-2.02 8.66-5.02-7.51-.25-13.1-6.66-8.32-14.96z" fill="currentColor"/>
                            </svg>
                            <span data-i18n="themeDark">深色</span>
                        </div>
                        <div class="theme-menu-item" data-theme="light">
                            <svg class="theme-menu-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="5" fill="currentColor"/>
                                <path d="M12 1v3M12 20v3M4.22 4.22l2.12 2.12M17.66 17.66l2.12 2.12M1 12h3M20 12h3M4.22 19.78l2.12-2.12M17.66 6.34l2.12-2.12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            <span data-i18n="themeLight">浅色</span>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <div class="current-site">
            <div class="site-info">
                <span class="site-label" data-i18n="currentSite">当前网站：</span>
                <span id="current-url" class="site-url">加载中...</span>
            </div>
        </div>

        <!-- Tab 导航 -->
        <div class="tab-nav">
            <button class="tab-btn active" data-tab="current-site">
                <span class="tab-icon">🎯</span>
                <span class="tab-text" data-i18n="tabCurrentSite">当前网站</span>
            </button>
            <button class="tab-btn" data-tab="all-browser">
                <span class="tab-icon">🌐</span>
                <span class="tab-text" data-i18n="tabAllBrowser">整个浏览器</span>
            </button>
            <button class="tab-btn" data-tab="settings">
                <span class="tab-icon">⚙️</span>
                <span class="tab-text" data-i18n="tabSettings">高级设置</span>
            </button>
        </div>

        <div class="actions-container">
            <!-- 当前网站 Tab 内容 -->
            <div class="tab-content active" id="current-site-tab">
                <!-- 重载功能区域 -->
                <div class="actions-grid">
                    <button id="normal-reload" class="btn btn-reload" data-i18n-title="normalReloadDesc">
                        <span class="btn-icon">🔄</span>
                        <span class="btn-text" data-i18n="normalReload">正常重新加载</span>
                    </button>
                    <button id="hard-reload-only" class="btn btn-reload" data-i18n-title="hardReloadDesc">
                        <span class="btn-icon">⚡</span>
                        <span class="btn-text" data-i18n="hardReload">硬性重新加载</span>
                    </button>
                    <button id="hard-reload-cache-only" class="btn btn-reload-cache" data-i18n-title="clearCacheAndHardReloadDesc">
                        <span class="btn-icon">🧹</span>
                        <span class="btn-text" data-i18n="clearCacheAndHardReload">清空缓存并硬性重新加载</span>
                    </button>
                </div>
                
                <!-- 分割线 -->
                <div class="section-divider"></div>
                
                <!-- 清理功能区域 -->
                <div class="actions-grid">
                    <button id="clear-current-all" class="btn btn-clean-primary" data-i18n-title="clearCacheDesc">
                        <span class="btn-icon">🗑️</span>
                        <span class="btn-text" data-i18n="clearCache">清空缓存</span>
                    </button>
                    <button id="hard-reload" class="btn btn-clean-danger" data-i18n-title="clearAllAndReloadDesc">
                        <span class="btn-icon">💥</span>
                        <span class="btn-text" data-i18n="clearAllAndReload">全部清空重载</span>
                    </button>
                </div>
                
                <!-- 分割线 -->
                <div class="section-divider"></div>
                
                <div class="actions-grid">
                    <button id="clear-current-cookies" class="btn btn-clean" data-i18n-title="cookiesDesc">
                        <span class="btn-icon">🍪</span>
                        <span class="btn-text" data-i18n="cookies">Cookies</span>
                    </button>
                    <button id="clear-localstorage" class="btn btn-clean" data-i18n-title="localStorageDesc">
                        <span class="btn-icon">💾</span>
                        <span class="btn-text" data-i18n="localStorage">LocalStorage</span>
                    </button>
                    <button id="clear-sessionstorage" class="btn btn-clean" data-i18n-title="sessionStorageDesc">
                        <span class="btn-icon">📂</span>
                        <span class="btn-text" data-i18n="sessionStorage">SessionStorage</span>
                    </button>
                    <button id="clear-current-indexeddb" class="btn btn-clean" data-i18n-title="indexedDBDesc">
                        <span class="btn-icon">🗄️</span>
                        <span class="btn-text" data-i18n="indexedDB">IndexedDB</span>
                    </button>
                </div>
                
                <!-- 分割线 -->
                <div class="section-divider"></div>
                
                <!-- 存储使用情况展示区域 -->
                <div class="storage-usage-section">
                    <div class="storage-usage-header">
                        <span class="storage-icon">📊</span>
                        <span class="storage-title" data-i18n="storageUsage">存储使用情况</span>
                        <button id="refresh-storage" class="refresh-btn" title="刷新存储信息">
                            <svg class="refresh-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20">
                                <path d="M989.311588 512.085547a36.053318 36.053318 0 0 0-38.613317 33.194652 438.570484 438.570484 0 0 1-138.794609 288.63988A438.186484 438.186484 0 0 1 511.999787 951.978697c-87.039964 0-171.093262-25.258656-243.199899-73.258636a439.63715 439.63715 0 0 1-148.778605-166.698598h99.967959a35.967985 35.967985 0 1 0 0-72.021303H36.010652a35.967985 35.967985 0 0 0-36.010652 36.010652v183.97859a35.967985 35.967985 0 1 0 72.021303 0v-85.973298A513.066453 513.066453 0 0 0 228.863905 938.666702C312.917203 994.517346 410.666496 1024 511.999787 1024c130.005279 0 253.994561-48.810646 349.013188-137.386609a509.653121 509.653121 0 0 0 161.493266-335.914527 35.967985 35.967985 0 0 0-33.194653-38.613317zM988.031588 128.000373a35.967985 35.967985 0 0 0-36.053318 36.010652v85.973298A512.298453 512.298453 0 0 0 795.007669 85.333724 509.439788 509.439788 0 0 0 511.999787 0.000427a510.122454 510.122454 0 0 0-349.013188 137.386609 510.207787 510.207787 0 0 0-161.5786 335.914527 36.053318 36.053318 0 0 0 33.194653 38.613317 36.053318 36.053318 0 0 0 38.613317-33.194653 438.570484 438.570484 0 0 1 138.794609-288.63988A438.613151 438.613151 0 0 1 511.999787 71.979063c87.039964 0 171.093262 25.301323 243.199898 73.301303a439.63715 439.63715 0 0 1 148.821272 166.741264h-100.010625a35.967985 35.967985 0 1 0 0 71.978637h183.97859A35.967985 35.967985 0 0 0 1023.999573 347.989615V164.011025A35.967985 35.967985 0 0 0 987.988922 128.000373z" fill="currentColor" opacity="0.65"/>
                            </svg>
                        </button>
                    </div>
                    <div id="storage-usage-content" class="storage-usage-content">
                        <div class="storage-loading" data-i18n="loadingStorage">正在加载存储信息...</div>
                    </div>
                </div>
            </div>

            <!-- 整个浏览器 Tab 内容 -->
            <div class="tab-content" id="all-browser-tab">
                <!-- 清理范围选择（仅作用于“整个浏览器”操作） -->
                <div class="time-range-row">
                    <div class="time-range-labels">
                        <span class="time-range-title" data-i18n="timeRangeLabel">清理范围</span>
                    </div>
                    <select id="time-range-select" class="filter-mode-select time-range-select">
                        <option value="hour" data-i18n="timeRangeLastHour">最近 1 小时</option>
                        <option value="day" data-i18n="timeRangeLastDay">最近 24 小时</option>
                        <option value="week" data-i18n="timeRangeLastWeek">最近 7 天</option>
                        <option value="month" data-i18n="timeRangeLastMonth">最近 4 周</option>
                        <option value="all" selected data-i18n="timeRangeAll">全部时间</option>
                    </select>
                </div>

                <!-- 一键清理 + 全局分析 -->
                <div class="actions-grid all-browser-top">
                    <button id="clear-all" class="btn btn-primary" data-i18n-title="clearAllCacheDesc">
                        <span class="btn-icon">🗑️</span>
                        <span class="btn-text" data-i18n="clearAllCache">一键清空所有缓存</span>
                    </button>
                    <button id="open-analysis" class="btn btn-success">
                        <span class="btn-icon">📈</span>
                        <span class="btn-text" data-i18n="openAnalysis">全局存储分析</span>
                    </button>
                </div>
                
                <!-- 分割线 -->
                <div class="section-divider"></div>
                
                <!-- 浏览器数据清理区域 -->
                <div class="actions-grid">
                    <button id="clear-cache" class="btn btn-clean">
                        <span class="btn-icon">📋</span>
                        <span class="btn-text" data-i18n="browserCache">浏览器缓存</span>
                    </button>
                    <button id="clear-cookies" class="btn btn-clean">
                        <span class="btn-icon">🍪</span>
                        <span class="btn-text" data-i18n="allCookies">所有 Cookies</span>
                    </button>
                    <button id="clear-indexeddb" class="btn btn-clean">
                        <span class="btn-icon">🗄️</span>
                        <span class="btn-text" data-i18n="allIndexedDB">所有 IndexedDB</span>
                    </button>
                    <button id="clear-history" class="btn btn-clean">
                        <span class="btn-icon">📖</span>
                        <span class="btn-text" data-i18n="clearHistory">清空历史记录</span>
                    </button>
                </div>

                <!-- 分割线 -->
                <div class="section-divider"></div>
                
                <!-- 下载管理区域 -->
                <div class="actions-grid">
                    <button id="clear-downloads" class="btn btn-clean">
                        <span class="btn-icon">⬇️</span>
                        <span class="btn-text" data-i18n="downloadHistory">下载记录</span>
                    </button>
                    <button id="clear-downloads-files" class="btn btn-danger">
                        <span class="btn-icon">🗂️</span>
                        <span class="btn-text" data-i18n="deleteDownloadFiles">删除下载文件</span>
                    </button>
                </div>
            </div>

            <!-- 高级设置 Tab 内容 -->
            <div class="tab-content" id="settings-tab">
                <!-- 清理选项 -->
                <div class="settings-group">
                    <div class="group-header">
                        <span class="group-icon">🔧</span>
                        <span class="group-title" data-i18n="cleaningOptions">清理选项</span>
                    </div>
                    <div class="settings-options">
                        <label class="setting-item">
                            <input type="checkbox" id="clear-passwords" checked>
                            <span class="setting-check"></span>
                            <span class="setting-text" data-i18n="keepPasswords">保留密码</span>
                        </label>
                        <label class="setting-item">
                            <input type="checkbox" id="clear-formdata" checked>
                            <span class="setting-check"></span>
                            <span class="setting-text" data-i18n="keepFormData">保留表单数据</span>
                        </label>
                        <label class="setting-item">
                            <input type="checkbox" id="include-protected" checked>
                            <span class="setting-check"></span>
                            <span class="setting-text" data-i18n="includeProtectedData">包含受保护数据</span>
                        </label>
                        <label class="setting-item">
                            <input type="checkbox" id="confirm-dangerous" checked>
                            <span class="setting-check"></span>
                            <span class="setting-text" data-i18n="confirmDangerous">危险操作二次确认</span>
                        </label>
                        <label class="setting-item">
                            <input type="checkbox" id="silent-mode">
                            <span class="setting-check"></span>
                            <span class="setting-text" data-i18n="silentMode">静默模式（无提示）</span>
                        </label>
                    </div>
                </div>
                
                <!-- 分割线 -->
                <div class="section-divider"></div>
                
                <!-- 通知设置 -->
                <div class="settings-group">
                    <div class="group-header">
                        <span class="group-icon">🔔</span>
                        <span class="group-title" data-i18n="notificationSettings">通知设置</span>
                    </div>
                    <div class="settings-options">
                        <label class="setting-item">
                            <input type="checkbox" id="enable-notifications" checked>
                            <span class="setting-check"></span>
                            <span class="setting-text" data-i18n="enableNotifications">启用通知</span>
                        </label>
                        <label class="setting-item">
                            <input type="checkbox" id="notification-sound">
                            <span class="setting-check"></span>
                            <span class="setting-text" data-i18n="notificationSound">通知声音</span>
                        </label>
                    </div>
                </div>
                
                <!-- 分割线 -->
                <div class="section-divider"></div>
                
                <!-- 域名过滤设置 -->
                <div class="settings-group">
                    <div class="group-header">
                        <span class="group-icon">🛡️</span>
                        <span class="group-title" data-i18n="domainFilter">域名过滤</span>
                    </div>
                    <div class="settings-options">
                        <div class="filter-mode-selector">
                            <label class="setting-label" data-i18n="filterMode">过滤模式：</label>
                            <select id="filter-mode-select" class="filter-mode-select">
                                <option value="disabled" data-i18n="filterModeDisabled">禁用</option>
                                <option value="whitelist" data-i18n="filterModeWhitelist">白名单</option>
                                <option value="blacklist" data-i18n="filterModeBlacklist">黑名单</option>
                            </select>
                        </div>
                        
                        <!-- 白名单区域 -->
                        <div id="whitelist-container" class="domain-list-container" style="display: none;">
                            <div class="domain-list-header">
                                <span class="domain-list-title" data-i18n="whitelist">白名单</span>
                                <button id="add-whitelist-btn" class="btn-add-domain" data-i18n="add">添加</button>
                            </div>
                            <div id="whitelist-list" class="domain-list"></div>
                        </div>
                        
                        <!-- 黑名单区域 -->
                        <div id="blacklist-container" class="domain-list-container" style="display: none;">
                            <div class="domain-list-header">
                                <span class="domain-list-title" data-i18n="blacklist">黑名单</span>
                                <button id="add-blacklist-btn" class="btn-add-domain" data-i18n="add">添加</button>
                            </div>
                            <div id="blacklist-list" class="domain-list"></div>
                        </div>
                        
                        <div class="filter-hint" data-i18n="domainFilterHint">
                            白名单模式：仅允许列表中的域名执行清理、右键菜单和存储扫描操作<br>
                            黑名单模式：阻止列表中的域名执行上述操作
                        </div>
                    </div>
                </div>
                
            </div>
        </div>

        <div class="status-container">
            <div id="status" class="status-message"></div>
            <div id="progress" class="progress-bar">
                <div class="progress-fill"></div>
            </div>
        </div>

        <!-- 危险操作确认弹窗 -->
        <div id="danger-confirm" class="danger-confirm">
            <div class="danger-confirm-content">
                <div class="danger-confirm-title" data-i18n="confirmDangerousTitle">确认执行危险操作？</div>
                <div class="danger-confirm-message" data-i18n="confirmDangerousMessage">此操作不可恢复，是否继续？</div>
                <div class="danger-confirm-actions">
                    <button id="danger-cancel" class="btn btn-clean" data-i18n="cancel">取消</button>
                    <button id="danger-ok" class="btn btn-primary" data-i18n="confirm">确认</button>
                </div>
            </div>
        </div>

        <footer class="footer">
            <div class="footer-text" data-i18n="footerTip">💡 提示：请谨慎使用删除功能，删除的数据无法恢复</div>
        </footer>
    </div>

    <!-- Service Worker桥接脚本，用于保持Service Worker活跃 -->
    <script src="service-worker-bridge.js"></script>
    <!-- 主弹窗脚本 -->
    <script src="popup.js" type="module"></script>
</body>
</html>
